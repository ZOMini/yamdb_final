## yamdb_final
[![Django-app workflow](https://github.com/ZOMini/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)](https://github.com/ZOMini/yamdb_final/actions/workflows/yamdb_workflow.yml)
яндекс облако(временно):
```
http://51.250.18.80/api/v1/
http://51.250.18.80/admin/
http://51.250.18.80/redoc/
```

Проект YaMDb собирает отзывы (Review) пользователей на произведения (Title). Произведения делятся на категории: «Книги», «Фильмы», «Музыка». Список категорий (Category) может быть расширен (например, можно добавить категорию «Изобразительное искусство» или «Ювелирка»).

Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку. <br>

В каждой категории есть произведения: книги, фильмы или музыка. Например, в категории «Книги» могут быть произведения «Винни Пух и все-все-все» и «Марсианские хроники», а в категории «Музыка» — песня «Давеча» группы «Насекомые» и вторая сюита Баха. Произведению может быть присвоен жанр из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»). Новые жанры может создавать только администратор. <br>

Благодарные или возмущённые читатели оставляют к произведениям текстовые отзывы (Review) и выставляют произведению рейтинг (оценку в диапазоне от одного до десяти). Из множества оценок автоматически высчитывается средняя оценка произведения.

## Инструкции для деплоя проекта на сервере

Последующие инструкции помогут вам настроить проект: <br>

### 1) Docker

Для того, чтобы развернуть проект на вашем сервере, вам необходимо предварительно установить Docker. <br>
Инструкция по установке: https://docs.docker.com/engine/install/

### 2) Автодеплой

В 'Actions secrets' в настройках вашего проекта на GitHub внесите необходимые параметры сервера: <br>

```
DOCKER_PASSWORD - Пароль от DockerHub (для обновления образа на DockerHub) <br>
DOCKER_USERNAME - Логин от DockerHub (для обновления образа на DockerHub) <br>
HOST - Публичный ip адрес сервера <br>
USER - Пользователь сервера <br>
PASSPHRASE - Если ssh-ключ защищен фразой-паролем <br>
SSH_KEY - Приватный ssh-ключ <br>
TELEGRAM_TO - ID телеграм-аккаунта (для оправки уведомления об успешном деплое) <br>
TELEGRAM_TOKEN - Токен бота (для оправки уведомления об успешном деплое) <br>
```

После успешного коммита и прохождения тестов ваш проект автоматически будет настроен на сервере, в случае успешного выполнения вы получите уведомление в Telegram. <br>

### При первом деплое

Запустите миграции при помощи следующей команды:

```
sudo docker-compose exec web python manage.py migrate --noinput
```

Для сбора статики запустите следующую команду:

```
sudo docker-compose exec web python manage.py collectstatic --noinput
```

Для загрузки тестовых данных (если необходимо) запустите следующую команду:

```
sudo docker-compose exec web python manage.py loaddata fixtures.json
```

Для создания суперпользователя запустите следующую команду:

```
sudo docker-compose exec web python manage.py createsuperuser
```

## Стек

### Django + Django REST Framework + gunicorn
Проект сделан по принципу RESTful API при помощи библиотеки Django REST Framework. <br> 
Лежит в отдельном контейнере и работает под web-сервером gunicorn.
### PostgreSQL
База данных лежит в отдельном контейнере.
### nginx
Сервер работает в отдельном контейнере.
### Docker
При помощи docker-compose происходит распаковка трёх контейнеров: база данных, web-сервер и nginx-сервер. Используются совместные тома памяти.
### GitHub Actions
Позволяет автоматически обновить проект на сервере в случае успешного прохождения тестов
